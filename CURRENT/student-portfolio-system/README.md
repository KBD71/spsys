# 📚 학생 포트폴리오 시스템 - Google Apps Script 버전

> Google Sheets 기반 과제 관리 + 학생 웹 인터페이스

## 🎯 시스템 개요

**Google Apps Script로 구현된 완전한 학생 관리 시스템**

### 교사용 기능
- ✅ 과제 생성 및 관리
- ✅ 동적 하이퍼링크 메뉴
- ✅ 시트 자동 생성
- ✅ 과제ID 자동 채번
- ✅ 평가 시스템

### 학생용 기능 (웹앱)
- ✅ 학생 로그인
- ✅ 내 기록 조회
- ✅ 평가 결과 확인
- ✅ 건의사항 입력

## 📁 파일 구조

```
src/
├── Main.gs              # 핵심 백엔드 로직 (3059줄)
├── WebApp.html          # 학생 웹 인터페이스 (1827줄)
└── appsscript.json      # Apps Script 설정
```

## 🚀 빠른 시작

### 1. Google Sheets 설정

1. Google Sheets에서 새 스프레드시트 생성
2. **확장 프로그램 > Apps Script** 메뉴 선택
3. `Main.gs` 파일의 전체 코드 복사하여 붙여넣기
4. 저장 후 실행

### 2. 초기 설정

Apps Script 에디터에서:

```javascript
// 함수 선택: setupCompleteInteractiveMenu
// 실행 버튼 클릭
```

권한 승인 후 자동으로:
- ✅ 메뉴 시트 생성
- ✅ 필수 시트 생성
- ✅ 메뉴바에 '포트폴리오' 추가
- ✅ 삭제 트리거 설정

### 3. 웹앱 배포 (학생용)

Apps Script 에디터에서:

```
배포 > 새 배포
→ 유형: 웹 앱
→ 실행 계정: 나
→ 액세스 권한: [조직 내 사용자]
→ 배포 버튼 클릭
→ URL 복사 (학생들에게 공유)
```

### 4. 사용 시작

**교사용** (Google Sheets):
- 상단 메뉴바에 **"📋 포트폴리오"** 탭 생성됨
- **메뉴로 이동** 클릭하여 관리 화면 접근

**학생용** (웹앱 URL):
- 배포된 URL 접속
- 학번으로 로그인
- 내 기록, 평가 결과 조회

## 📊 시스템 구조

### 필수 시트 (⭐)

| 시트명 | 설명 | 자동생성 |
|--------|------|----------|
| 메뉴 | 중앙 관리 허브 | ✅ |
| 학생명단_전체 | 전체 학생 데이터 | ❌ 수동 |
| 과제설정 | 과제 정보 저장 | ✅ |
| 공개 | 공개 설정 관리 | ✅ |
| template | 시트 템플릿 | ❌ 수동 |

### 동적 생성 시트

- 과제 시트: 새 과제 생성 시 자동 생성
- 헤더: template 시트 구조 우선 적용
- 질문 컬럼: 과제별 동적 추가

## 🎨 주요 기능

### 1. 과제 시트 생성

**메뉴: 포트폴리오 > 새 과제 시트**

1. 과제명 입력
2. 시작일/마감일 입력 (YYYY-MM-DD)
3. 질문 개수 입력 (0-20개)
4. 각 질문 내용 입력

**자동 처리**:
- ✅ 과제ID 자동 생성 (TS001, TS002...)
- ✅ 과제설정 시트에 데이터 저장
- ✅ 공개 시트에 자동 등록
- ✅ 새 시트 생성 (헤더 포함)
- ✅ 메뉴 자동 업데이트

### 2. 메뉴 시스템

**하이퍼링크 기반 탐색**:
- 시트명 클릭 → 해당 시트로 이동
- 카테고리별 색상 구분
- 삭제 체크박스 (필수 시트는 보호)

**카테고리**:
- ⭐ 필수 (빨강) - 삭제 불가
- 👥 학급 (파랑)
- 📝 과제 (주황)
- 📊 평가 (보라)
- 📁 선택 (녹색)

### 3. 시트 삭제

체크박스 클릭 시:
1. 확인 대화상자 표시
2. 시트 삭제
3. 과제설정 시트에서 해당 행 삭제
4. 공개 시트에서 해당 행 삭제
5. 메뉴 자동 갱신

## 🔧 상수 및 설정

### COLUMN_INDEX
```javascript
{
  PUBLIC: 0,           // 공개 여부
  ASSIGNMENT_ID: 1,    // 과제ID
  ASSIGNMENT_NAME: 2,  // 과제명
  TARGET_SHEET: 3,     // 대상시트
  START_DATE: 4,       // 시작일
  END_DATE: 5,         // 마감일
  QUESTION_START: 6    // 질문 시작 컬럼
}
```

### ROW_INDEX
```javascript
{
  HEADER: 1,           // 헤더 행
  DATA_START: 2        // 데이터 시작 행
}
```

### SHEET_NAMES
```javascript
{
  ASSIGNMENT_SETTINGS: '과제설정',
  PUBLIC: '공개',
  MENU: '메뉴',
  TEMPLATE: 'template',
  STUDENT_LIST: '학생명단_전체'
}
```

### REQUIRED_SHEETS
```javascript
['학생명단_전체', '과제설정', '공개', 'template']
```

## 📝 과제설정 시트 구조

| 공개 | 과제ID | 과제명 | 대상시트 | 시작일 | 마감일 | 질문1 | 질문2 | ... |
|------|--------|--------|----------|--------|--------|-------|-------|-----|
| ☐ | TS001 | 에세이 과제 | 에세이 과제 | 2025-01-01 | 2025-01-31 | 주제는? | 분량은? | ... |

## 🔐 보안 및 검증

### 날짜 검증
- **형식**: YYYY-MM-DD (정규식 검증)
- **유효성**: 실제 존재하는 날짜인지 확인
- **순서**: 시작일 ≤ 마감일

### 과제ID 중복 방지
- 기존 ID 중 최대값 찾기
- maxId + 1로 새 ID 생성
- 행 삭제 후에도 중복 없음

### 시트명 중복 처리
- 중복 시 자동으로 번호 추가
- 예: "과제1", "과제1_1", "과제1_2"

## 🎯 주요 함수

| 함수명 | 기능 | 실행 위치 |
|--------|------|-----------|
| `createAssignmentSheet()` | 새 과제 시트 생성 | 메뉴 > 새 과제 시트 |
| `updateSheetList()` | 시트 목록 갱신 | 메뉴 > 시트 목록 정렬 |
| `deleteSheetByName(name)` | 시트 삭제 | 메뉴의 체크박스 |
| `setupCompleteInteractiveMenu()` | 메뉴 시스템 초기화 | 메뉴 > 메뉴 초기화 |
| `goToMenu()` | 메뉴로 이동 | 메뉴 > 메뉴로 이동 |
| `isValidDate(dateString)` | 날짜 검증 | 내부 함수 |

## 🔄 메뉴바 구성

**📋 포트폴리오**
- 📋 메뉴로 이동
- ───────
- 🔄 시트 목록 정렬
- ➕ 새 과제 시트
- ───────
- 🔧 메뉴 초기화

## 🐛 문제 해결

### Q: 메뉴가 안 보여요
**A**: `setupCompleteInteractiveMenu()` 함수 실행

### Q: 시트 삭제가 안 돼요
**A**: 필수 시트(⭐)는 삭제 불가입니다

### Q: 날짜 입력 오류
**A**: YYYY-MM-DD 형식 확인 (예: 2025-01-01)

### Q: 과제ID가 중복돼요
**A**: 과제설정 시트에서 기존 ID 확인, 수동 수정 필요

### Q: template 시트가 없어요
**A**: 수동으로 생성하거나, 기본 헤더 사용됨

## 📈 향후 계획

- [ ] 파일 업로드 기능 (Google Drive)
- [ ] 통계 대시보드
- [ ] 모바일 앱 최적화
- [ ] 알림 시스템

## 🤝 기여

- **GitHub**: https://github.com/KBD71/spsys
- **Issues**: https://github.com/KBD71/spsys/issues

## 📄 라이선스

MIT License

---

**마지막 업데이트**: 2025-10-03
**현재 버전**: v2.0 (과제 관리 + 학생 웹앱)
**작업자**: KBD71

**주요 업데이트 (v2.0)**:
- ✅ 학생 로그인 및 웹 인터페이스 복원
- ✅ 내 기록 조회 기능
- ✅ 평가 결과 조회 기능
- ✅ 건의사항 입력 기능
