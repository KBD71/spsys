# 📚 학생 포트폴리오 시스템 (Student Portfolio System)

> Google Sheets 기반 과제 관리 시스템

## 🌟 프로젝트 개요

Google Apps Script로 구현된 간단하면서도 강력한 과제 관리 시스템입니다.
Google Sheets의 강력한 협업 기능과 Apps Script의 자동화를 결합하여 교사와 학생 모두에게 편리한 학습 관리 환경을 제공합니다.

## ✨ 주요 기능

### 👨‍🏫 교사용 기능

**📝 과제 관리**
- **과제 생성**: 과제명, 날짜, 질문 항목 설정
- **자동 ID 생성**: TS001, TS002... 중복 방지
- **시트 자동 생성**: 과제별 전용 시트 생성
- **공개 설정**: 과제별 공개/비공개 관리

**🎨 동적 메뉴 시스템**
- **하이퍼링크 탐색**: 시트명 클릭으로 빠른 이동
- **카테고리 자동 분류**: 필수/학급/과제/평가/선택
- **시트 삭제 보호**: 필수 시트 자동 보호
- **실시간 업데이트**: 변경사항 자동 반영

**📊 평가 시스템**
- **평가 항목 설정**: 평가명, 배점, 대상반 설정
- **세부 항목 관리**: 항목별 배점 및 기준
- **학생별 평가 입력**: 점수 및 코멘트 기록
- **평가 결과 통계**: 반별 평균, 최고/최저점

### 👨‍🎓 학생용 기능 (웹앱)

**🔐 인증 시스템**
- **학번 로그인**: 5자리 학번으로 간편 로그인
- **개인 정보 확인**: 이름, 반 정보 조회

**📋 내 기록 조회**
- **공개 항목 조회**: 교사가 공개 설정한 항목만 표시
- **반별 필터링**: 본인 반에 해당하는 항목만 표시
- **건의사항 입력**: 시트별 건의사항 작성 가능

**📊 평가 결과 확인**
- **평가별 점수**: 항목별 세부 점수 확인
- **교사 코멘트**: 평가에 대한 피드백 확인
- **종합 점수**: 평가별 총점 및 만점 표시

## 🚀 빠른 시작

### 필수 요구사항
- Google 계정
- Google Sheets 접근 권한

### 설치 방법 (5분)

1. **Google Sheets 생성**
   ```
   새 스프레드시트 생성
   이름: "학생 포트폴리오 시스템"
   ```

2. **Apps Script 열기**
   ```
   메뉴 > 확장 프로그램 > Apps Script
   ```

3. **코드 복사**
   ```
   CURRENT/student-portfolio-system/src/Main.gs
   → Apps Script 에디터에 붙여넣기
   ```

4. **초기 설정 실행**
   ```javascript
   함수: setupCompleteInteractiveMenu
   실행 → 권한 승인
   ```

5. **완료!**
   ```
   스프레드시트로 돌아가면
   상단 메뉴에 "📋 포트폴리오" 탭 생성됨
   ```

## 📁 프로젝트 구조

```
spsys/
├── README.md                                    # 프로젝트 개요
├── WORKSPACE.md                                 # 작업 현황
│
├── CURRENT/student-portfolio-system/            # 메인 시스템 (활성)
│   ├── src/
│   │   ├── Main.gs                             # 핵심 로직 (3059줄)
│   │   ├── WebApp.html                         # 학생 웹 인터페이스 (1827줄)
│   │   └── appsscript.json                     # 설정
│   └── README.md                               # 상세 가이드
│
├── VERCEL/student-portfolio-vercel/             # (사용 안 함)
│   └── ...
│
└── ARCHIVE/                                     # 아카이브
    └── desktop-v1/                             # 과거 버전
```

## 🎯 시스템 구조

### Google Sheets 시트 구성

| 시트명 | 역할 | 자동생성 | 삭제가능 |
|--------|------|----------|----------|
| **메뉴** | 중앙 관리 허브 | ✅ | ❌ |
| **학생명단_전체** | 학생 데이터 | ❌ | ❌ |
| **과제설정** | 과제 정보 저장 | ✅ | ❌ |
| **공개** | 공개 설정 | ✅ | ❌ |
| **template** | 시트 템플릿 | ❌ | ❌ |
| *(과제 시트)* | 과제별 데이터 | ✅ | ✅ |

### 과제설정 시트 예시

| 공개 | 과제ID | 과제명 | 대상시트 | 시작일 | 마감일 | 질문1 | 질문2 |
|------|--------|--------|----------|--------|--------|-------|-------|
| ☐ | TS001 | 에세이1 | 에세이1 | 2025-01-01 | 2025-01-31 | 주제는? | 분량은? |
| ☑ | TS002 | 실험보고서 | 실험보고서 | 2025-02-01 | 2025-02-28 | 가설은? | 결과는? |

## 🎨 사용 방법

### 1. 과제 생성

```
메뉴: 📋 포트폴리오 > ➕ 새 과제 시트

1. 과제명 입력
2. 시작일 입력 (YYYY-MM-DD)
3. 마감일 입력 (YYYY-MM-DD)
4. 질문 개수 입력 (0-20)
5. 각 질문 내용 입력
```

**자동 처리**:
- ✅ 과제ID 자동 생성 (중복 방지)
- ✅ 과제설정 시트에 저장
- ✅ 공개 시트에 등록
- ✅ 새 시트 생성 (헤더 포함)
- ✅ 메뉴 자동 업데이트

### 2. 시트 탐색

```
메뉴 시트에서:
- 시트명 클릭 → 해당 시트로 이동
- 카테고리별 색상 구분
  ⭐ 필수 (빨강)
  👥 학급 (파랑)
  📝 과제 (주황)
  📊 평가 (보라)
  📁 선택 (녹색)
```

### 3. 시트 삭제

```
메뉴 시트에서:
1. 삭제할 시트의 체크박스 클릭
2. 확인 대화상자에서 확인
3. 자동으로:
   - 시트 삭제
   - 과제설정에서 행 삭제
   - 공개에서 행 삭제
   - 메뉴 갱신
```

## 🔧 주요 함수

| 함수 | 기능 | 실행 방법 |
|------|------|-----------|
| `createAssignmentSheet()` | 새 과제 시트 생성 | 메뉴 > 새 과제 시트 |
| `updateSheetList()` | 시트 목록 갱신 | 메뉴 > 시트 목록 정렬 |
| `setupCompleteInteractiveMenu()` | 메뉴 시스템 초기화 | 메뉴 > 메뉴 초기화 |
| `goToMenu()` | 메뉴로 이동 | 메뉴 > 메뉴로 이동 |
| `deleteSheetByName(name)` | 시트 삭제 | 메뉴의 체크박스 |

## 🔐 보안 및 검증

### 입력 검증
- ✅ 날짜 형식 검증 (YYYY-MM-DD)
- ✅ 날짜 유효성 검증 (2025-02-30 → 오류)
- ✅ 날짜 순서 검증 (시작일 ≤ 마감일)
- ✅ 질문 개수 제한 (0-20개)

### 데이터 무결성
- ✅ 과제ID 중복 방지 (maxId + 1 방식)
- ✅ 시트명 중복 처리 (자동 넘버링)
- ✅ 필수 시트 삭제 방지
- ✅ 트랜잭션 무결성 (삭제 시 관련 데이터 일괄 삭제)

## 🐛 문제 해결

| 문제 | 해결 방법 |
|------|-----------|
| 메뉴가 안 보여요 | `setupCompleteInteractiveMenu()` 실행 |
| 시트 삭제가 안 돼요 | 필수 시트(⭐)는 삭제 불가 |
| 날짜 입력 오류 | YYYY-MM-DD 형식 확인 (예: 2025-01-01) |
| template 시트 없음 | 수동 생성 또는 기본 헤더 사용 |

## 📈 향후 계획

- [ ] **파일 업로드**: Google Drive 연동
- [ ] **통계 대시보드**: 데이터 시각화
- [ ] **모바일 최적화**: 반응형 UI 개선
- [ ] **알림 시스템**: 과제 마감 알림

## 🤝 기여 및 지원

### GitHub
- **저장소**: https://github.com/KBD71/spsys
- **Issues**: https://github.com/KBD71/spsys/issues
- **Pull Requests**: 기여 환영!

### 문서
- **메인 가이드**: [CURRENT/student-portfolio-system/README.md](./CURRENT/student-portfolio-system/README.md)
- **작업 현황**: [WORKSPACE.md](./WORKSPACE.md)

## 📊 프로젝트 통계

- **코드 줄 수**: 737 줄
- **주요 함수**: 15개
- **지원 기능**: 과제 관리, 메뉴 시스템
- **플랫폼**: Google Apps Script
- **라이선스**: MIT

## 📜 라이선스

MIT License - 자유롭게 사용, 수정, 배포 가능

---

## 📞 연락처

- **작업자**: KBD71
- **마지막 업데이트**: 2025-10-03
- **현재 버전**: v1.0 (과제 관리 시스템)

---

**Made with ❤️ for Education**
