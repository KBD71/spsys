# 학생 포트폴리오 시스템 - 설계 문서

## 📋 시스템 개요

학생들이 과제를 제출하고, 자신의 기록을 조회하며, 피드백을 받을 수 있는 시스템

---

## 🏗️ Google Sheets 구조

### 1. 학생명단_전체
```
학번 | 반 | 번호 | 이름 | 비밀번호 | 이메일 | 상태 | 비밀번호변경일 | 변경횟수
```

### 2. 과제설정
```
공개 | 과제아이디 | 과제명 | 대상시트 | 시작일 | 마감일 | 질문1 | 질문2 | 질문3 | 질문4 | 질문5
```

**컬럼 설명:**
- `공개`: "Y" 또는 "N" - 학생에게 보이는지 여부
- `과제아이디`: 고유 ID (예: A001, A002)
- `과제명`: 과제 제목
- `대상시트`: 학생 응답이 저장될 시트 이름
- `시작일`, `마감일`: 과제 기간
- `질문1~5`: (사용 안 함 - 대상시트의 헤더가 질문이 됨)

### 3. 평가항목설정
```
과제아이디 | 평가항목1 | 평가항목2 | 평가항목3 | 평가항목4 | 평가항목5
```

### 4. 학생응답 시트들 (예: "자기소개서", "진로계획서" 등)

**규칙:**
- 반드시 `학번 | 반 | 이름`으로 시작
- 그 뒤에 교사가 만든 질문 컬럼들
- 헤더 이름이 학생에게 표시될 질문이 됨

**예시 - "자기소개서" 시트:**
```
학번 | 반 | 이름 | 자기소개 | 장래희망 | 특기 | 좋아하는과목 | 제출일시
10101 | 1 | 홍길동 | 안녕하세요... | 개발자 | 코딩 | 수학 | 2025-10-02
```

### 5. 기타 시트 (수업평가서, 행발특기사항 등)

**구조:**
```
학번 | 반 | 이름 | [교사가 정의한 컬럼들...] | [공개여부 컬럼?]
```

---

## 🔄 시스템 플로우

### A. 과제 제출

```
1. 학생 로그인
   ↓
2. 대시보드에서 "공개=Y"인 과제 목록 조회
   ↓
3. 과제 선택 (예: "자기소개서 작성")
   ↓
4. 시스템이 "대상시트" (예: "자기소개서") 헤더 읽기
   - 헤더: 학번 | 반 | 이름 | 자기소개 | 장래희망 | 특기 | 좋아하는과목
   - 질문: 자기소개, 장래희망, 특기, 좋아하는과목 (앞 3개 제외)
   ↓
5. 학생에게 질문 표시 + 입력 폼
   ↓
6. 학생이 답변 입력 후 제출
   ↓
7. 시스템이 "자기소개서" 시트에서 학생의 학번 행 찾기
   - 있으면: 해당 행 업데이트
   - 없으면: 새 행 추가 (학번, 반, 이름, 답변들, 제출일시)
```

### B. 내 기록 보기

```
1. 학생 로그인
   ↓
2. "내 기록" 메뉴 선택
   ↓
3. 시스템이 조회 가능한 시트 목록 제공
   (교사가 지정한 시트 + 컬럼)
   ↓
4. 학생이 시트 선택 (예: "행발특기사항")
   ↓
5. 해당 시트에서 학생의 학번 행만 조회
   - 교사가 지정한 컬럼만 표시
   ↓
6. 학생이 내용 확인
   ↓
7. (선택) 피드백 입력 → 저장
```

---

## 🎯 API 설계

### 1. GET /api/assignments?studentId={학번}

**기능:** 학생에게 공개된 과제 목록 조회

**로직:**
1. `과제설정` 시트 읽기
2. `공개 = "Y"` 필터링
3. 현재 날짜가 시작일~마감일 사이인지 확인
4. 학생의 반 정보와 대상반 매칭 (필요시)

**응답:**
```json
{
  "success": true,
  "assignments": [
    {
      "id": "A001",
      "name": "자기소개서 작성",
      "targetSheet": "자기소개서",
      "startDate": "2025-10-01",
      "dueDate": "2025-10-15",
      "submitted": false
    }
  ]
}
```

---

### 2. GET /api/assignment-detail?assignmentId={과제ID}&studentId={학번}

**기능:** 과제 상세 정보 및 질문 조회

**로직:**
1. `과제설정`에서 과제 정보 가져오기
2. `대상시트` 이름 확인
3. 대상시트의 헤더 읽기
4. 학번/반/이름 제외한 컬럼들을 질문으로 반환
5. 학생이 이미 제출했는지 확인 (학번 행 존재 여부)

**응답:**
```json
{
  "success": true,
  "assignment": {
    "id": "A001",
    "name": "자기소개서 작성",
    "targetSheet": "자기소개서",
    "dueDate": "2025-10-15"
  },
  "questions": [
    {"column": "자기소개", "answer": "안녕하세요..."},
    {"column": "장래희망", "answer": "개발자"},
    {"column": "특기", "answer": "코딩"},
    {"column": "좋아하는과목", "answer": "수학"}
  ],
  "submitted": true,
  "submittedAt": "2025-10-02T10:00:00Z"
}
```

---

### 3. POST /api/submit-assignment

**기능:** 과제 제출 (학생 응답 저장)

**요청:**
```json
{
  "studentId": "10101",
  "assignmentId": "A001",
  "answers": {
    "자기소개": "안녕하세요, 저는...",
    "장래희망": "소프트웨어 개발자",
    "특기": "프로그래밍",
    "좋아하는과목": "수학"
  }
}
```

**로직:**
1. `과제설정`에서 `대상시트` 이름 가져오기
2. `학생명단_전체`에서 학생의 반, 이름 가져오기
3. 대상시트에서 학생의 학번 행 찾기
4. 행이 있으면 업데이트, 없으면 새 행 추가:
   ```
   학번 | 반 | 이름 | 자기소개 | 장래희망 | 특기 | 좋아하는과목 | 제출일시
   10101 | 1 | 홍길동 | 안녕... | 개발자 | 코딩 | 수학 | 2025-10-02T10:00:00Z
   ```

**응답:**
```json
{
  "success": true,
  "message": "과제가 제출되었습니다."
}
```

---

### 4. GET /api/my-records?studentId={학번}

**기능:** 학생의 기록 조회 (교사가 지정한 시트+컬럼)

**로직:**
1. 조회 가능한 시트 목록 확인 (설정 필요 - 아래 참조)
2. 각 시트에서 학생의 학번 행 찾기
3. 공개 가능한 컬럼만 필터링
4. 데이터 반환

**응답:**
```json
{
  "success": true,
  "records": [
    {
      "sheetName": "행발특기사항",
      "columns": ["특기사항", "담임평가"],
      "data": {
        "학번": "10101",
        "이름": "홍길동",
        "특기사항": "리더십이 뛰어남",
        "담임평가": "매우 우수"
      }
    }
  ]
}
```

---

## ❓ 설정 필요 사항

### Q1. 학생에게 보여줄 컬럼 지정 방법

**옵션 A: 과제설정 시트에 추가**
```
공개 | 과제아이디 | 과제명 | 대상시트 | ... | 공개컬럼
Y    | A001      | 자기소개서 | 자기소개서 | ... | 자기소개,장래희망,특기
```

**옵션 B: 별도 "공개설정" 시트 생성**
```
시트이름 | 공개여부 | 공개컬럼
자기소개서 | Y | 자기소개,장래희망,특기
행발특기사항 | Y | 특기사항,담임평가
```

**옵션 C: 헤더에 특수 표시**
```
학번 | 반 | 이름 | [공개]자기소개 | [공개]장래희망 | [비공개]내부메모
```

**어떤 방식을 선호하시나요?**

---

### Q2. 피드백 저장 위치

학생이 자신의 기록을 보고 피드백을 남길 때:

**옵션 A: 같은 시트에 "피드백" 컬럼 추가**
```
학번 | 반 | 이름 | 특기사항 | 담임평가 | 학생피드백
10101 | 1 | 홍길동 | 리더십 우수 | 매우 우수 | 감사합니다!
```

**옵션 B: 별도 "피드백" 시트**
```
학번 | 시트이름 | 피드백내용 | 작성일시
10101 | 행발특기사항 | 감사합니다! | 2025-10-02
```

**어떤 방식을 선호하시나요?**

---

이 두 가지 질문에 답변해주시면, 바로 구현을 시작하겠습니다!
