# 학생 포트폴리오 시스템 사용자 매뉴얼

## 1. 시스템 개요 🗺️

본 시스템은 Google Sheets를 백엔드(데이터베이스)로, Vercel에 배포된 웹 페이지를 프론트엔드(학생용 인터페이스)로 사용하는 학생 과제 관리 및 포트폴리오 시스템입니다.

- **백엔드 (교사용)**: Google Sheets 내에서 과제 생성, 학생 관리, 제출 현황 확인, AI를 활용한 평가 등 모든 관리 작업을 수행합니다.
- **프론트엔드 (학생용)**: 학생들은 웹 브라우저를 통해 Vercel 페이지에 접속하여 과제를 확인하고, 답변을 제출하며, 교사의 피드백을 확인합니다.

---

## 2. 최초 관리자 설정 (Initial Admin Setup) 🛠️

시스템을 처음 배포하고 사용하기 위한 전체 과정입니다.

### 2.1. Google Cloud 설정 및 서비스 계정 생성

Vercel 서버가 Google Sheets에 접근할 수 있도록 '로봇 계정(Service Account)'을 생성하고 권한을 부여하는 과정입니다.

1.  **Google Cloud Console 접속**: [Google Cloud Console](https://console.cloud.google.com/)에 접속하여 새 프로젝트를 생성합니다.
2.  **API 활성화**: `APIs & Services > Library`에서 **"Google Sheets API"**를 검색하여 활성화(Enable)합니다.
3.  **서비스 계정 생성**:
    - `IAM & Admin > Service Accounts`로 이동하여 `+ CREATE SERVICE ACCOUNT`를 클릭합니다.
    - 서비스 계정 이름(예: `spsys-robot`)을 입력하고 생성을 완료합니다.
4.  **JSON 키 발급**:
    - 생성된 서비스 계정을 클릭하고, `KEYS` 탭으로 이동합니다.
    - `ADD KEY > Create new key`를 선택하고, 키 유형은 **JSON**으로 하여 키를 생성하고 컴퓨터에 다운로드합니다. **이 파일은 재발급되지 않으니 안전하게 보관하세요.**

### 2.2. Google Sheets 설정

1.  **시트 생성**: 새로운 Google Sheets 파일을 하나 생성합니다. 이 파일이 시스템의 모든 데이터가 저장될 데이터베이스가 됩니다.
2.  **서비스 계정 초대**:
    - 시트 오른쪽 상단의 **`Share`** 버튼을 클릭합니다.
    - 다운로드한 JSON 파일 안에 있는 `"client_email"` 값을 복사하여 'Add people and groups'에 붙여넣습니다.
    - 권한을 **`Editor`**로 설정하고 초대합니다.

### 2.3. Google Apps Script 배포 (백엔드)

1.  Google Sheets 파일에서 `Extensions > Apps Script`를 엽니다.
2.  `CURRENT/student-portfolio-system` 폴더에 있는 모든 `.gs` 파일과 `.html` 파일의 내용을 Apps Script 편집기에 각각 생성하고 붙여넣습니다. (`appsscript.json` 포함)
3.  저장 후, 편집기 오른쪽 상단의 **`Deploy > New deployment`**를 클릭합니다.
4.  '유형 선택'에서 톱니바퀴 아이콘을 클릭하고 **`Web app`**을 선택합니다.
5.  'Execute as'는 **`Me`**로, 'Who has access'는 **`Anyone with Google account`** 또는 조직에 맞게 설정합니다.
6.  **`Deploy`** 버튼을 눌러 배포를 완료합니다.

### 2.4. Vercel 배포 (프론트엔드)

1.  `VERCEL/student-portfolio-vercel` 폴더를 GitHub 저장소에 올립니다.
2.  Vercel에 로그인하여 해당 GitHub 저장소를 `Import`하여 새 프로젝트를 생성합니다.
3.  프로젝트의 `Settings > Environment Variables` 메뉴로 이동하여 다음 환경 변수들을 등록합니다.
    - `GOOGLE_SERVICE_ACCOUNT_EMAIL`: JSON 파일의 `"client_email"` 값을 붙여넣습니다.
    - `GOOGLE_PRIVATE_KEY`: JSON 파일의 `"private_key"` 값을 `-----BEGIN PRIVATE KEY-----` 부터 `-----END PRIVATE KEY-----\n` 까지 **전체**를 복사하여 붙여넣습니다.
    - `SPREADSHEET_ID`: Google Sheets URL의 `.../spreadsheets/d/` 와 `/edit` 사이에 있는 긴 문자열 ID를 붙여넣습니다.
4.  환경 변수를 저장하고 프로젝트를 재배포(Redeploy)합니다.

### 2.5. 시스템 초기화

1.  Google Sheets 파일로 돌아와 페이지를 새로고침하면 **'📋 포트폴리오 관리'** 메뉴가 나타납니다.
2.  **`📋 포트폴리오 관리 > ⚙️ 시스템 설정 > 초기화: 필수 시트 생성`**을 클릭하여 시스템 운영에 필요한 모든 시트를 자동으로 생성합니다.
3.  **`📋 포트폴리오 관리 > ⚙️ 시스템 설정 > ⚠️ 중요: AI용 트리거 설치`**를 클릭하여 '초안생성' 체크박스가 작동하도록 설정합니다.

---

## 3. 교사용 기능 안내 (Google Sheets) 👨‍🏫

### 3.1. 핵심 시트 설명

| 시트 이름 | 주 요 기 능 |
| :--- | :--- |
| **`메뉴`** | 시스템 현황 대시보드. 과제별/반별 제출률 및 미제출 학생 명단을 확인합니다. |
| **`학생명단_전체`** | 학생 정보(학번, 반, 번호, 이름)와 초기 비밀번호를 관리합니다. |
| **`과제설정`** | 과제의 세부 정보(과제명, 기간, 질문 내용, 재제출 허용 여부 등)를 설정합니다. |
| **`공개`** | `과제설정`에 등록된 과제를 학생들에게 공개할지 여부와 대상 반을 지정합니다. |
| **`프롬프트`** | AI가 '종합의견' 등을 생성할 때 사용할 역할과 지시사항을 정의합니다. |
| **`template`** | 새 과제 시트의 기본 양식. 'AI 검사 결과' 열이 포함되어 있습니다. |

### 3.2. 주요 기능 사용법

#### 🧑‍🎓 학생 관리
- `학생명단_전체` 시트에 학번(5자리 숫자), 반, 번호, 이름, 초기 비밀번호를 입력하여 학생을 등록합니다.

#### 📝 새 과제 생성 및 관리
1.  **과제 생성**: `📋 포트폴리오 관리 > ➕ 새 과제 시트 생성`을 클릭하여 사이드바에서 과제명, 기간, 질문(최대 20개)을 입력하고 생성합니다.
2.  **과제 공개**: `공개` 시트로 이동하여 해당 과제의 '공개' 체크박스를 선택합니다. '대상반' 열에 과제를 수행할 반의 학번 앞 3자리(예: `101, 106`)를 입력하거나, 전체 대상일 경우 비워둡니다.
3.  **재제출 허용**: 학생이 제출물을 수정해야 할 경우, `과제설정` 시트에서 해당 과제의 '재제출허용' 체크박스를 선택하거나, 해당 과제 시트에서 학생의 제출 행을 직접 삭제합니다.

#### 📊 대시보드 활용
- `메뉴` 시트를 확인하여 실시간 제출 현황을 파악합니다.
- `🔄 대시보드 새로고침` 메뉴를 클릭하여 데이터를 최신 상태로 업데이트합니다.
- '미제출 학생 명단' 열에 마우스를 올리면 반/번호 순으로 정렬된 전체 명단을 확인할 수 있습니다.

#### 🤖 AI 기능 활용
- **API 키 설정**: 최초 1회, `🤖 AI 기능 > 🔑 AI API 키 설정` 메뉴에서 발급받은 Gemini API 키를 입력해야 합니다.
- **종합의견 초안 생성**: 과제 시트에서 학생의 답변을 확인한 후, '초안생성' 열의 체크박스를 클릭하면 '종합의견' 열에 AI가 초안을 작성합니다.
- **AI 사용(표절) 검사**: AI 사용이 의심되는 학생의 행을 클릭한 후, `🤖 AI 기능 > 🕵️ 선택된 행 AI 사용 검사` 메뉴를 실행하면 'AI 검사 결과' 열에 분석 결과가 표시됩니다.

---

## 4. 학생용 기능 안내 (웹 페이지) 🧑‍🎓

1.  **로그인**: 교사에게 받은 5자리 학번과 초기 비밀번호로 로그인합니다.
2.  **과제 목록 확인**: 메인 화면에 제출해야 할 과제 목록이 표시됩니다. 제출이 완료되고 재제출이 허용되지 않은 과제는 '[제출완료]'로 표시되며 비활성화됩니다.
3.  **과제 제출**:
    - 과제를 클릭하여 질문에 답변을 작성합니다. 작성 중인 내용은 브라우저에 **자동으로 임시 저장**됩니다.
    - '제출하기' 버튼을 누르면 최종 제출되며, 임시 저장된 내용은 삭제됩니다.
4.  **기록 확인**: '내 기록' 섹션에서 교사가 작성한 코멘트나 AI 첨삭 결과 등의 피드백을 확인할 수 있습니다.
5.  **비밀번호 변경**: '🔑 비밀번호 변경' 버튼을 통해 언제든지 자신의 비밀번호를 변경할 수 있습니다.

---

## 5. FAQ 및 문제 해결

- **Q: 메뉴가 나타나지 않아요.**
  - A: Google Sheets 페이지를 새로고침 해보세요. Apps Script가 로드되는 데 시간이 걸릴 수 있습니다.
- **Q: AI 기능 실행 시 'API 키가 설정되지 않았습니다' 오류가 발생해요.**
  - A: `🤖 AI 기능 > 🔑 AI API 키 설정` 메뉴에서 유효한 Gemini API 키를 다시 한번 정확하게 입력해주세요.
- **Q: 학생 웹페이지에서 과제 목록이 보이지 않아요.**
  - A: `공개` 시트에서 해당 과제의 '공개' 체크박스가 선택되었는지, '대상반' 설정이 올바른지 확인해주세요. 또한, `과제설정` 시트의 '시작일'과 '마감일'이 현재 날짜 범위에 맞는지 확인해주세요.
- **Q: Vercel 배포에 실패했어요.**
  - A: Vercel 프로젝트의 환경 변수(`GOOGLE_SERVICE_ACCOUNT_EMAIL`, `GOOGLE_PRIVATE_KEY`, `SPREADSHEET_ID`)가 정확하게 입력되었는지 다시 확인해주세요. 특히 `PRIVATE_KEY`는 전체 내용을 빠짐없이 복사해야 합니다.
